{% extends 'base.html' %}
{% block content %}
{% load static %}

<style>
/* ================== NARROW RESTAURANT CARD ================== */

.restaurant-card {
  max-width: 450px; /* made it narrower */
  margin: 2rem auto;
  padding: 1.8rem 2rem;
  background-color: #f9fafb;
  border-radius: 1rem;
  border: 1px solid #e5e7eb;
  text-align: center;
  font-family: system-ui, sans-serif;
  transition: transform 0.2s ease;
}

.restaurant-card:hover {
  transform: translateY(-2px);
}

.restaurant-card img {
  width: 180px;
  height: 180px;
  object-fit: cover;
  border-radius: 1rem;
  margin-bottom: 1rem;
  border: 2px solid #e5e7eb;
}

.restaurant-card h1 {
  font-size: 1.6rem;
  color: #2c326a;
  margin-bottom: 0.3rem;
  font-weight: 700;
}

.restaurant-card h2 {
  font-size: 1rem;
  color: #6b7280;
  margin-bottom: 0.8rem;
}

.restaurant-card ul {
  list-style: none;
  padding: 0;
  margin: 0.5rem 0 1rem 0;
  display: flex;
  flex-wrap: wrap;
  justify-content: center;
  gap: 0.6rem;
}

.restaurant-card ul li {
  background-color: #e5e7eb;
  padding: 0.35rem 0.8rem;
  border-radius: 999px;
  font-size: 0.85rem;
  color: #111827;
}

.restaurant-card .status {
  display: inline-block;
  padding: 0.35rem 0.8rem;
  border-radius: 0.6rem;
  font-weight: 600;
  margin-bottom: 0.8rem;
  font-size: 0.85rem;
}

.restaurant-card .status.open {
  background-color: #d1fae5;
  color: #065f46;
}

.restaurant-card .status.closed {
  background-color: #fee2e2;
  color: #991b1b;
}

.restaurant-card a {
  display: inline-block;
  padding: 0.45rem 1rem;
  margin: 0.3rem;
  border-radius: 999px;
  text-decoration: none;
  font-weight: 600;
  font-size: 0.85rem;
  transition: all 0.2s ease;
}

.restaurant-card a.update {
  background-color: #2c326a;
  color: white;
}

.restaurant-card a.update:hover {
  background-color: #1f244f;
}

.restaurant-card a.delete {
  background-color: #dc2626;
  color: white;
}

.restaurant-card a.delete:hover {
  background-color: #991b1b;
}

.restaurant-card a.back {
  background-color: #fbbf24;
  color: #1f2933;
}

.restaurant-card a.back:hover {
  background-color: #f59e0b;
}

/* Responsive */
@media (max-width: 480px) {
  .restaurant-card {
    padding: 1.5rem;
  }

  .restaurant-card img {
    width: 150px;
    height: 150px;
  }

  .restaurant-card h1 {
    font-size: 1.4rem;
  }

  .restaurant-card h2 {
    font-size: 0.95rem;
  }

  .restaurant-card ul li {
    font-size: 0.8rem;
    padding: 0.3rem 0.6rem;
  }

  .restaurant-card a {
    font-size: 0.8rem;
    padding: 0.4rem 0.9rem;
  }
}
</style>

<div class="restaurant-card">

  <img src="{% static restaurant.image|cut:'main_app/static/' %}" alt="Restaurant Image">

  <h1>{{ restaurant.name }} in {{ restaurant.get_city_display }}</h1>
  <h2>{{ restaurant.description }}</h2>

  <ul>
    {% for category in restaurant.categories.all %}
      <li>{{ category.name }}</li>
    {% endfor %}
  </ul>

  {% if user.profile.role == 'owner' %}
    {% if not restaurant.is_open %}
      <p class="status closed">Opens at {{ restaurant.open_at|time:"h:i A" }}</p>
      <p class="status closed">Closes at {{ restaurant.close_at|time:"h:i A" }}</p>
    {% endif %}
    <a class="update" href="{% url 'restaurant_update' restaurant.id %}">Update</a>
    <a class="delete" href="{% url 'restaurant_delete' restaurant.id %}">Delete</a>

  {% else %}
    {% if not restaurant.is_open %}
      <p class="status closed">{{ restaurant.name }} is closed â€” opens at {{ restaurant.open_at|time:"h:i A" }}</p>
    {% else %}
      <p class="status open">Closes at {{ restaurant.close_at|time:"h:i A" }}</p>
    {% endif %}
  {% endif %}

  <a class="back" href="{% url 'restaurants_index' %}">Back</a>

</div>
 <hr />
  <!-- for Items -->
  <div>
    {%if user.profile.role == 'owner'%}
    <h1>Add A New Item</h1>
     {% if object %}
  <h1>Edit {{object.name}}</h1>
  {% else %}
  <h1>Add item </h1>
  {% endif %}
  <form action="{% url 'add_item' restaurant.id %}" method="post" enctype="multipart/form-data">
    {% csrf_token %}
    <table>
      {{ item_form.as_table }}
    </table>
    <input type="submit" name="submit" class="btn">
  </form>
    {% endif %}
  </div>
  <div>
    {% for item in restaurant.item_set.all %}
    <h3>{{ item.name }}</h3>
    <p>Description: {{item.description }}</p>
    <p>price: {{ item.price }}BD</p>
    <div>
      {% load static %}
      <img src="{%static item.itemImage|cut:'main_app/static/' %}"alt="Item image"/>
    </div>
    <div>
      {% if user.profile.role == "owner" %}
      <a href="{% url 'item_update' item.id %}">Edit</a>
      <a href="{% url 'item_delete' item.id%}">Delete</a>
      {% endif %}
    </div>
    <!-- for customer Cart -->
    <div>
      {% if user.profile.role == "customer" %}
      <form action="{% url 'addToCart' user.id item.id restaurant.id %}" method="post">
        {% csrf_token %} {{ add_to_cart_form.as_p }}
        <input type="submit" value="Add To Cart" />
      </form>
      {% endif %} {% endfor%}
    </div>
  </div>
</div>
{%endblock%}
